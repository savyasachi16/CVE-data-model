from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker

from config import DATABASE_URI
from models import Base, CVE, CPE, Junction


class Database:
    def __init__(self):
        self.engine = create_engine(DATABASE_URI)
        self.connection = self.engine.connect()
        self.Session = sessionmaker(bind=self.engine)
        print("DB Instance created!")

    def createAllTables(self):
        Base.metadata.create_all(self.engine)
        print("Created Tables Successfully!")

    def dropAllTables(self):
        Base.metadata.drop_all(self.engine)
        print("Dropped Tables Successfully!")

    def insertRows(self, cves):
        s = self.Session()
        print("Began writing to Database...")
        s.execute(CVE.__table__.insert(),cves)
        s.commit()
        print("Insertion to Database Complete.")

    def updateRows(self):
        pass

    def deleteRows(self):
        pass

    def getTopVulnerableProducts(self):
        pass

    def getRoundedScoreCVECount(self):
        pass
